<h1 class="text-2xl font-bold text-white mb-6">Reports Management</h1>
  
<% if @reports.any? %>
  <div class="overflow-x-auto">
    <table class="min-w-full bg-gray-800 border border-gray-700 text-gray-300">
      <thead>
        <tr>
          <th class="px-4 py-3 border-b border-gray-700 text-gray-200">Reported Item</th>
          <th class="px-4 py-3 border-b border-gray-700 text-gray-200">Reported User</th>
          <th class="px-4 py-3 border-b border-gray-700 text-gray-200">Reason</th>
          <th class="px-4 py-3 border-b border-gray-700 text-gray-200">Reporter</th>
          <th class="px-4 py-3 border-b border-gray-700 text-gray-200">Status</th>
          <th class="px-4 py-3 border-b border-gray-700 text-gray-200">Date</th>
          <th class="px-4 py-3 border-b border-gray-700 text-gray-200">Actions</th>
        </tr>
      </thead>
      <tbody>
        <% @reports.each do |report| %>
          <tr class="hover:bg-gray-700">
            <td class="px-4 py-3 border-b border-gray-700">
              <% if report.reportable_type == "Post" %>
                <div class="text-sm font-medium text-white">Post</div>
                <div class="text-sm text-gray-400">
                  <%= link_to "View Post", post_path(report.reportable), class: "text-blue-400 hover:underline" %>
                </div>
                <div class="text-xs text-gray-500 mt-1">
                  <%= report.reportable.text.truncate(50) %>
                </div>
              <% elsif report.reportable_type == "User" %>
                <div class="text-sm font-medium text-white">User</div>
                <div class="text-sm text-gray-400">
                  <%= link_to "@#{report.reportable.username}", user_profile_path(report.reportable.username), class: "text-blue-400 hover:underline" %>
                </div>
              <% elsif report.reportable_type == "Conversation" %>
                <div class="text-sm font-medium text-white">Conversation</div>
                <div class="text-sm text-gray-400">
                  <%= link_to "View Conversation", conversation_path(report.reportable), class: "text-blue-400 hover:underline" %>
                </div>
                <div class="text-xs text-gray-500 mt-1">
                  Participants: <%= report.reportable.users.pluck(:username).join(", ") %>
                </div>
              <% end %>
            </td>
    <td class="px-4 py-3 border-b border-gray-700">
      <% if report.reportable_type == "Post" %>
        <%= link_to "@#{report.reportable.user.username}", user_profile_path(report.reportable.user.username), class: "text-blue-400 hover:underline" %>
      <% elsif report.reportable_type == "User" %>
        <%= link_to "@#{report.reportable.username}", user_profile_path(report.reportable.username), class: "text-blue-400 hover:underline" %>
      <% elsif report.reportable_type == "Conversation" %>
        <span class="text-gray-400">Multiple Users</span>
        <div class="text-xs text-gray-500 mt-1">
          <%= report.reportable.users.map { |u| link_to "@#{u.username}", user_profile_path(u.username), class: "text-blue-400 hover:underline" }.join(", ").html_safe %>
        </div>
      <% end %>
    </td>
    <td class="px-4 py-3 border-b border-gray-700">
      <span class="px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full 
        <%= case report.reason
            when 'spam' then 'bg-yellow-800 text-yellow-100'
            when 'insult' then 'bg-red-800 text-red-100'
            when 'fraud' then 'bg-purple-800 text-purple-100'
            when 'impersonation' then 'bg-blue-800 text-blue-100'
            end %>">
        <%= report.reason.humanize %>
      </span>
    </td>
    <td class="px-4 py-3 border-b border-gray-700">
      <div class="text-sm text-gray-400">
        <%= link_to "@#{report.reporter.username}", user_profile_path(report.reporter.username), class: "text-blue-400 hover:underline" %>
      </div>
    </td>
    <td class="px-4 py-3 border-b border-gray-700">
      <span class="px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full 
        <%= case report.status
            when 'pending' then 'bg-yellow-800 text-yellow-100'
            when 'archived' then 'bg-blue-800 text-blue-100'
            when 'resolved' then 'bg-green-800 text-green-100'
            else 'bg-gray-800 text-gray-100'
            end %>">
        <%= report.status.humanize %>
      </span>
    </td>
    <td class="px-4 py-3 border-b border-gray-700">
      <%= report.created_at.strftime("%Y-%m-%d %H:%M") %>
    </td>
    <td class="px-4 py-3 border-b border-gray-700">
      <div class="flex space-x-2">
        <% if report.status == 'pending' %>
          <%= button_to "Archive", admin_report_path(report), method: :patch, params: { archive: true }, class: "bg-yellow-600 hover:bg-yellow-700 text-white py-1 px-2 rounded text-xs" %>
          <%= button_to "Suspend", admin_report_path(report), method: :patch, params: { suspend_user: true }, class: "bg-red-600 hover:bg-red-700 text-white py-1 px-2 rounded text-xs" %>
        <% end %>
        <%= button_to "Delete", admin_report_path(report), method: :delete, class: "bg-gray-600 hover:bg-gray-700 text-white py-1 px-2 rounded text-xs", data: { confirm: "Are you sure you want to delete this report?" } %>
      </div>
    </td>
  </tr>
<% end %>
</tbody>
</table>
</div>

<div class="mt-4">
<%== pagy_nav(@pagy) %>
</div>
<% else %>
<p class="text-gray-400">No reports found.</p>
<% end %>