<% content_for :title, "#{@post.user.full_name || @post.user.username} (@#{@post.user.username}) on Weuz" %>
<% content_for :description, strip_tags(@post.text) %>
<% if @post.images.attached? && @post.images.first %>
  <% content_for :head do %>
    <meta property="og:image" content="<%= url_for(@post.images.first) %>">
    <meta property="twitter:image" content="<%= url_for(@post.images.first) %>">
    <meta property="twitter:card" content="summary_large_image">
  <% end %>
<% end %>

<div class="max-w-2xl mx-auto px-4 py-6">
  <!-- Back Navigation -->
  <div class="mb-6">
    <a href="javascript:history.back()" class="inline-flex items-center text-blue-400 hover:text-blue-300 transition-colors">
      <span class="mr-2">←</span>
      Back
    </a>
  </div>

  <!-- Original Post (if this is a reply) -->
  <% if @post.is_reply? %>
    <div class="mb-4">
      <div class="border-l-4 border-gray-800 pl-4">
        <h4 class="text-sm font-medium text-gray-400 mb-2">Original Post</h4>
        <%= render 'post', post: @post.in_reply_to_post %>
      </div>
    </div>
  <% end %>

  <!-- Main Post -->
  <div class="mb-6">
    <%= render 'post', post: @post %>
  </div>

  <!-- Reply Form -->
  <% if Current.user %>
    <%= render 'reply_form', post: @post, reply_post: @reply_post %>
  <% end %>

<!-- Replies Section -->
<div class="space-y-1">
  <h3 class="text-lg font-medium text-white mb-4">
    Replies 
    <span class="text-sm font-normal text-gray-400">(<%= @replies.count %>)</span>
  </h3>
  
  <div id="replies">
    <% if @replies.any? %>
      <% @replies.each do |reply| %>
        <%= render 'post', post: reply %>
      <% end %>
    <% else %>
      <div class="bg-gray-900 rounded-xl border border-gray-800 p-6 text-center">
        <p class="text-gray-400">No replies yet. Be the first to reply!</p>
      </div>
    <% end %>
  </div>
</div>
</div>
